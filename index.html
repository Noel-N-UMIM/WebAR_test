<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Universal AR.js (Hiro)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    
    <!-- 1. Libraries: A-Frame 1.2.0 + AR.js -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <style>
      body { margin: 0; overflow: hidden; font-family: sans-serif; }
      
      /* New UI Layer for the Button */
      #ui-layer {
        position: absolute;
        bottom: 30px;
        left: 0;
        width: 100%;
        text-align: center;
        z-index: 100;
        pointer-events: none; /* Let clicks pass through around the button */
      }

      #jump-btn {
        pointer-events: auto; /* Enable clicking on the button itself */
        padding: 15px 30px;
        font-size: 20px;
        font-weight: bold;
        background-color: #4CC3D9;
        color: white;
        border: 3px solid white;
        border-radius: 30px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        transition: transform 0.1s;
      }
      
      #jump-btn:active {
        transform: scale(0.95);
        background-color: #3aa8b9;
      }
    </style>

    <script>
      // Component to handle button click
      AFRAME.registerComponent('jump-listener', {
        init: function () {
          const btn = document.querySelector('#jump-btn');
          const el = this.el;
          
          // When button is clicked, emit the event to start animation
          btn.addEventListener('click', () => {
            el.emit('start-jump');
          });
        }
      });
    </script>
  </head>

  <body style="margin: 0; overflow: hidden;">
    
    <!-- UI Button -->
    <div id="ui-layer">
      <button id="jump-btn">JUMP!</button>
    </div>

    <!-- 
      AR.js Scene Config 
    -->
    <a-scene 
      embedded 
      arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
      vr-mode-ui="enabled: false"
      renderer="logarithmicDepthBuffer: true;">

      <a-assets>
        <img id="boxTexture" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/cubes.jpg">
      </a-assets>

      <!-- 
        HIRO MARKER 
      -->
      <a-marker preset="hiro">
        
        <!-- The Content: A box that spins AND jumps -->
        <!-- 
          animation__rotation: Constant spinning
          animation__jump: Triggered by button (startEvents: start-jump)
          loop: 2 with dir: alternate creates one full Up-Down cycle
        -->
        <a-box 
          jump-listener
          position="0 0.5 0" 
          material="src: #boxTexture; color: #4CC3D9"
          animation__rotation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear"
          animation__jump="property: position; from: 0 0.5 0; to: 0 1.5 0; dur: 300; dir: alternate; loop: 2; startEvents: start-jump; easing: easeOutQuad">
        </a-box>

      </a-marker>

      <!-- Camera -->
      <a-entity camera></a-entity>

    </a-scene>
  </body>
</html>
